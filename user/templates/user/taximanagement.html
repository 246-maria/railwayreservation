{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Manage Taxis</title>
  <style>
    body {
      font-family: 'Times New Roman', Times, serif;
      background-image: url("{% static 'images/WhatsApp Image 2025-04-11 at 11.36.08_8ccf0fac.jpg' %}");
      background-position: center;
      background-repeat: no-repeat;
      background-size: cover;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
      margin: 0;
      padding: 20px;
    }
    .container {
      background-color: white;
      padding: 40px;
      border-radius: 16px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
      max-width: 1200px; 
      width: 100%;
      text-align: center;
    }
    h2 {
      text-align: left;
      color: green;
      border-bottom: 2px solid green;
      padding-bottom: 10px;
      margin-bottom: 20px;
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 10px;
    }
    h3{
        text-align: left;
        color: black;
    }
    .logo {
      width: 50px;
      height: auto;
      margin-right: 10px;
      padding-top: 3px;
    }
    .form-group {
      margin-bottom: 15px;
      text-align: left;
    }
    .form-group label {
      display: block;
      margin-bottom: 5px;
      font-weight: bold;
    }
    .form-group input, .form-group select {
      width: 100%;
      padding: 8px;
      box-sizing: border-box;
      border: 1px solid #ccc;
      border-radius: 4px;
    }
    .btn-group {
      margin-top: 20px;
      display: flex;
      justify-content: space-between;
      gap: 10px;
    }
    .btn {
      padding: 10px 20px;
      border-radius: 5px;
      font-size: 16px;
      cursor: pointer;
      border: none;
      transition: background-color 0.3s ease;
    }
    .btn-primary {
      background-color: green;
      color: white;
    }
    .btn-primary:hover {
      background-color: rgb(20, 146, 20);
    }
    .btn-danger {
      background-color: #dc3545;
      color: white;
    }
    .btn-danger:hover {
      background-color: #c82333;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 20px;
    }
    table, th, td {
      border: 1px solid #ddd;
    }
    th, td {
      padding: 12px;
      text-align: left;
    }
    th {
      background-color: darkgreen;
      color: white;
    }
    tr:nth-child(even) {
      background-color: #f9f9f9;
    }
  </style>
</head>
<body>
  <div class="container">
    <h2 style="display: flex; align-items: center; justify-content: left; gap: 10px;">
            <img src="{% static 'images/logo.jpg' %}" alt="My Logo"
                style="width: 50px; height: auto; margin-right: 10px; padding-top: 3px;" />
      Taxi Management
    </h2>
    
    {% if messages %}
      {% for message in messages %}
        <div class="alert alert-{{ message.tags }}">
          {{ message }}
        </div>
      {% endfor %}
    {% endif %}

    <h3>All Taxis</h3>
    <div>
    <table>
      <thead>
        <tr>
          <th>ID</th>
          <th>Driver Name</th>
          <th>Contact</th>
          <th>Taxi Number</th>
          <th>Taxi Name</th>
          <th>City</th>
          <th>Travel Date</th>
          <th>Travel Time</th>
          <th>From</th>
          <th>To</th>
          <th>Fare</th>
          <th>Status</th>
          <th>Availability</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        {% for taxi in taxis %}
        <tr>
          <td>{{ taxi.pk }}</td>
          <td>{{ taxi.driver_name }}</td>
          <td>{{ taxi.driver_contact }}</td>
          <td>{{ taxi.taxi_number }}</td>
          <td>{{ taxi.taxi_name }}</td>
          <td>{{ taxi.city }}</td>
          <td>{{ taxi.travel_date}}</td>
          <td>{{ taxi.travel_time}}</td>
          <td>{{ taxi.from_location }}</td>
          <td>{{ taxi.to_location }}</td>
          <td>{{ taxi.fare }}</td>
          <td>{{ taxi.status }}</td>
          <td>{{ taxi.availability }}</td>
          <td>
            <button class="btn btn-primary" onclick="editTaxi('{{ taxi.pk }}', '{{ taxi.driver_name }}', '{{ taxi.driver_contact }}', '{{ taxi.taxi_number }}', '{{ taxi.from_location }}', '{{ taxi.to_location }}', '{{ taxi.city }}', '{{ taxi.total_fare }}', '{{ taxi.availability }}', '{{ taxi.booking_status }}')">Edit</button>
            <form action="{% url 'taxi_management' %}" method="POST" style="display:inline;">
              {% csrf_token %}
              <input type="hidden" name="action" value="delete">
              <input type="hidden" name="taxi_id" value="{{ taxi.pk }}">
              <button type="submit" class="btn btn-danger" onclick="return confirm('Are you sure you want to delete this taxi?')">Delete</button>
            </form>
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
    </div>

    <h3>Add/Update Taxi</h3>
    <form action="{% url 'taxi_management' %}" method="POST" id="taxi-form">
      {% csrf_token %}
      <input type="hidden" name="action" id="form-action" value="add">
      <input type="hidden" name="taxi_id" id="taxi-id">
      
      <div class="form-group">
        <label for="driver_name">Driver Name</label>
        <input type="text" name="driver_name" id="driver_name" required>
      </div>
      <div class="form-group">
        <label for="driver_contact">Driver Contact</label>
        <input type="text" name="driver_contact" id="driver_contact" maxlength="11">
      </div>
      <div class="form-group">
        <label for="taxi_number">Taxi Number</label>
        <input type="text" name="taxi_number" id="taxi_number" maxlength="5">
      </div>
      <div class="form-group">
<label for="taxi_name">Taxi Name</label>
<input type="text" name="taxi_name" id="taxi_name" required>

      </div>
      <div class="form-group">
        <label for="city">City</label>
        <select name="city" id="city" required>
            <option value="">--Select City--</option>
            <option value="Karachi">Karachi</option>
            <option value="Lahore">Lahore</option>
            <option value="Islamabad">Islamabad</option>
            <option value="Peshawar">Peshawar</option>
            <option value="Quetta">Quetta</option>
            <option value="Multan">Multan</option>
            <option value="Faisalabad">Faisalabad</option>
            <option value="Hyderabad">Hyderabad</option>
            <option value="Gujranwala">Gujranwala</option>
            <option value="Sialkot">Sialkot</option>
            <option value="Rawalpindi">Rawalpindi</option>
            <option value="Gujrat">Gujrat</option>
            <option value="Bahawalpur">Bahawalpur</option>
            <option value="Sukkur">Sukkur</option>
            <option value="Sargodha">Sargodha</option>
            <option value="Mardan">Mardan</option>
            <option value="Abbottabad">Abbottabad</option>
            <option value="Mirpur">Mirpur</option>
            <option value="Muzaffarabad">Muzaffarabad</option>
            <option value="Gawadar">Gawadar</option>
        </select>
      </div>
      
      <div class="form-group">
        <label for="from_location">From Location</label>
        <input type="text" name="from_location" id="from_location" required>
      </div>
      <div class="form-group">
        <label for="to_location">To Location</label>
        <input type="text" name="to_location" id="to_location" required>
      </div>
      <div class="form-group">
        <label for="travel_date">Travel Date</label>
        <input type="date" name="travel_date" id="travel_date" required>
      </div>
      <div class="form-group">
        <label for="travel_time">Travel Time</label>
        <input type="time" name="travel_time" id="travel_time" required>
      </div>
      <div class="form-group">
        <label for="fare_per_km">Total Fare (PKR)</label>
        <input type="number" step="0.01" name="fare" id="fare" required>
      </div>
      <div class="form-group">
        <label for="availability">Availability</label>
        <select name="availability" id="availability" required>
          <option value="True">Available</option>
          <option value="False">Not Available</option>
        </select>
      </div>
      <div class="form-group">
        <label for="status">Booking Status</label>
        <select name="status" id="status" required>
          <option value="Available">Available</option>
          <option value="Booked">Booked</option>
        </select>
      </div>

      <div class="btn-group">
        <button type="submit" class="btn btn-primary" id="submit-btn">Add Taxi</button>
      </div>
    </form>
  </div>

  <script>
    function editTaxi(id, driverName, contact, number, fromLoc, toLoc, city, fare, availability, status) {
      document.getElementById('form-action').value = 'update';
      document.getElementById('taxi-id').value = id;
      document.getElementById('driver_name').value = driverName;
      document.getElementById('driver_contact').value = contact;
      document.getElementById('taxi_number').value = number;
      document.getElementById('from_location').value = fromLoc;
      document.getElementById('to_location').value = toLoc;
      document.getElementById('city').value = city;
      document.getElementById('travel_date').value =travel_date;
      document.getElementById('travel_time').value = travel_time;
      document.getElementById('fare').value = fare;
      document.getElementById('availability').value = availability === 'True' ? 'True' : 'False';
      document.getElementById('booking_status').value = status;
      document.getElementById('submit-btn').innerText = 'Update Taxi';
    }
  </script>
</body>
</html>
